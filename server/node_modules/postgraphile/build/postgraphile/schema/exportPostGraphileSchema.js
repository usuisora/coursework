"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs_1 = require("fs");
const graphql_1 = require("graphql");
async function writeFileAsync(path, contents) {
    await new Promise((resolve, reject) => {
        fs_1.writeFile(path, contents, error => {
            if (error)
                reject(error);
            else
                resolve();
        });
    });
}
/**
 * Exports a PostGraphile schema by looking at a Postgres client.
 */
async function exportPostGraphileSchema(schema, options = {}) {
    // JSON version
    if (typeof options.exportJsonSchemaPath === 'string') {
        const result = await graphql_1.graphql(schema, graphql_1.introspectionQuery);
        await writeFileAsync(options.exportJsonSchemaPath, JSON.stringify(result, null, 2));
    }
    // Schema language version
    if (typeof options.exportGqlSchemaPath === 'string') {
        await writeFileAsync(options.exportGqlSchemaPath, graphql_1.printSchema(schema));
    }
}
exports.default = exportPostGraphileSchema;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhwb3J0UG9zdEdyYXBoaWxlU2NoZW1hLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3Bvc3RncmFwaGlsZS9zY2hlbWEvZXhwb3J0UG9zdEdyYXBoaWxlU2NoZW1hLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsMkJBQStCO0FBQy9CLHFDQUFrRjtBQUVsRixLQUFLLHlCQUF5QixJQUFZLEVBQUUsUUFBZ0I7SUFDMUQsTUFBTSxJQUFJLE9BQU8sQ0FBQyxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsRUFBRTtRQUNwQyxjQUFTLENBQUMsSUFBSSxFQUFFLFFBQVEsRUFBRSxLQUFLLENBQUMsRUFBRTtZQUNoQyxJQUFJLEtBQUs7Z0JBQUUsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDOztnQkFDcEIsT0FBTyxFQUFFLENBQUM7UUFDakIsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUM7QUFFRDs7R0FFRztBQUNZLEtBQUssbUNBQ2xCLE1BQXFCLEVBQ3JCLFVBR0ksRUFBRTtJQUVOLGVBQWU7SUFDZixJQUFJLE9BQU8sT0FBTyxDQUFDLG9CQUFvQixLQUFLLFFBQVEsRUFBRTtRQUNwRCxNQUFNLE1BQU0sR0FBRyxNQUFNLGlCQUFPLENBQUMsTUFBTSxFQUFFLDRCQUFrQixDQUFDLENBQUM7UUFDekQsTUFBTSxjQUFjLENBQUMsT0FBTyxDQUFDLG9CQUFvQixFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0tBQ3JGO0lBRUQsMEJBQTBCO0lBQzFCLElBQUksT0FBTyxPQUFPLENBQUMsbUJBQW1CLEtBQUssUUFBUSxFQUFFO1FBQ25ELE1BQU0sY0FBYyxDQUFDLE9BQU8sQ0FBQyxtQkFBbUIsRUFBRSxxQkFBVyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7S0FDeEU7QUFDSCxDQUFDO0FBakJELDJDQWlCQyJ9