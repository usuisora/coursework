{"version":3,"sources":["../../src/plugins/PgConnectionArgOrderByDefaultValue.js"],"names":["PgConnectionArgOrderByDefaultValue","builder","hook","args","build","context","extend","getTypeByName","pgGetGqlTypeByTypeIdAndModifier","inflection","scope","isPgFieldConnection","pgFieldIntrospection","table","Self","field","kind","namespace","isSelectable","orderBy","TableType","type","id","tableTypeName","name","TableOrderByType","orderByType","defaultValueEnum","getValues","find","v","defaultValue","value"],"mappings":";;;;;;kBAGgB,SAASA,kCAAT,CAA4CC,OAA5C,EAAqD;AACnEA,UAAQC,IAAR,CACE,qCADF,EAEE,CAACC,IAAD,EAAOC,KAAP,EAAcC,OAAd,KAA0B;AACxB,UAAM;AACJC,YADI;AAEJC,mBAFI;AAGJC,qCAHI;AAIJC;AAJI,QAKFL,KALJ;AAMA,UAAM;AACJM,aAAO,EAAEC,mBAAF,EAAuBC,sBAAsBC,KAA7C,EADH;AAEJC,UAFI;AAGJC;AAHI,QAIFV,OAJJ;;AAMA,QACE,CAACM,mBAAD,IACA,CAACE,KADD,IAEAA,MAAMG,IAAN,KAAe,OAFf,IAGA,CAACH,MAAMI,SAHP,IAIA,CAACJ,MAAMK,YAJP,IAKA,CAACf,KAAKgB,OANR,EAOE;AACA,aAAOhB,IAAP;AACD;AACD,UAAMiB,YAAYZ,gCAAgCK,MAAMQ,IAAN,CAAWC,EAA3C,EAA+C,IAA/C,CAAlB;AACA,UAAMC,gBAAgBH,UAAUI,IAAhC;AACA,UAAMC,mBAAmBlB,cACvBE,WAAWiB,WAAX,CAAuBH,aAAvB,CADuB,CAAzB;AAGA,QAAI,CAACE,gBAAL,EAAuB;AACrB,aAAOtB,IAAP;AACD;;AAED,UAAMwB,mBACJF,iBAAiBG,SAAjB,GAA6BC,IAA7B,CAAkCC,KAAKA,EAAEN,IAAF,KAAW,iBAAlD,KACAC,iBAAiBG,SAAjB,GAA6B,CAA7B,CAFF;;AAIA,WAAOtB,OAAOH,IAAP,EAAa;AAClBgB,eAASb,OACPH,KAAKgB,OADE,EAEP;AACEY,sBAAcJ,oBAAoB,CAACA,iBAAiBK,KAAlB;AADpC,OAFO,EAKN,6CAA4CjB,MAAMS,IAAK,SACtDV,KAAKU,IACN,GAPM;AADS,KAAb,CAAP;AAWD,GAjDH;AAmDD,C","file":"PgConnectionArgOrderByDefaultValue.js","sourcesContent":["// @flow\nimport type { Plugin } from \"graphile-build\";\n\nexport default (function PgConnectionArgOrderByDefaultValue(builder) {\n  builder.hook(\n    \"GraphQLObjectType:fields:field:args\",\n    (args, build, context) => {\n      const {\n        extend,\n        getTypeByName,\n        pgGetGqlTypeByTypeIdAndModifier,\n        inflection,\n      } = build;\n      const {\n        scope: { isPgFieldConnection, pgFieldIntrospection: table },\n        Self,\n        field,\n      } = context;\n\n      if (\n        !isPgFieldConnection ||\n        !table ||\n        table.kind !== \"class\" ||\n        !table.namespace ||\n        !table.isSelectable ||\n        !args.orderBy\n      ) {\n        return args;\n      }\n      const TableType = pgGetGqlTypeByTypeIdAndModifier(table.type.id, null);\n      const tableTypeName = TableType.name;\n      const TableOrderByType = getTypeByName(\n        inflection.orderByType(tableTypeName)\n      );\n      if (!TableOrderByType) {\n        return args;\n      }\n\n      const defaultValueEnum =\n        TableOrderByType.getValues().find(v => v.name === \"PRIMARY_KEY_ASC\") ||\n        TableOrderByType.getValues()[0];\n\n      return extend(args, {\n        orderBy: extend(\n          args.orderBy,\n          {\n            defaultValue: defaultValueEnum && [defaultValueEnum.value],\n          },\n          `Adding defaultValue to orderBy for field '${field.name}' of '${\n            Self.name\n          }'`\n        ),\n      });\n    }\n  );\n}: Plugin);\n"]}