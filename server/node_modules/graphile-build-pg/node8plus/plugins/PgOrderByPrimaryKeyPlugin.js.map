{"version":3,"sources":["../../src/plugins/PgOrderByPrimaryKeyPlugin.js"],"names":["PgOrderByPrimaryKeyPlugin","builder","hook","values","build","context","extend","scope","isPgRowSortEnum","pgIntrospection","table","kind","primaryKeyConstraint","primaryKeys","keyAttributes","PRIMARY_KEY_ASC","value","alias","specs","map","key","name","unique","PRIMARY_KEY_DESC"],"mappings":";;;;;;kBAGgB,SAASA,yBAAT,CAAmCC,OAAnC,EAA4C;AAC1DA,UAAQC,IAAR,CAAa,wBAAb,EAAuC,CAACC,MAAD,EAASC,KAAT,EAAgBC,OAAhB,KAA4B;AACjE,UAAM,EAAEC,MAAF,KAAaF,KAAnB;AACA,UAAM;AACJG,aAAO,EAAEC,eAAF,EAAmBC,iBAAiBC,KAApC;AADH,QAEFL,OAFJ;;AAIA,QAAI,CAACG,eAAD,IAAoB,CAACE,KAArB,IAA8BA,MAAMC,IAAN,KAAe,OAAjD,EAA0D;AACxD,aAAOR,MAAP;AACD;AACD,UAAMS,uBAAuBF,MAAME,oBAAnC;AACA,QAAI,CAACA,oBAAL,EAA2B;AACzB,aAAOT,MAAP;AACD;AACD,UAAMU,cAAcD,qBAAqBE,aAAzC;;AAEA,WAAOR,OACLH,MADK,EAEL;AACEY,uBAAiB;AACfC,eAAO;AACLC,iBAAO,iBADF;AAELC,iBAAOL,YAAYM,GAAZ,CAAgBC,OAAO,CAACA,IAAIC,IAAL,EAAW,IAAX,CAAvB,CAFF;AAGLC,kBAAQ;AAHH;AADQ,OADnB;AAQEC,wBAAkB;AAChBP,eAAO;AACLC,iBAAO,kBADF;AAELC,iBAAOL,YAAYM,GAAZ,CAAgBC,OAAO,CAACA,IAAIC,IAAL,EAAW,KAAX,CAAvB,CAFF;AAGLC,kBAAQ;AAHH;AADS;AARpB,KAFK,EAkBJ,8CAA6CZ,MAAMW,IAAK,GAlBpD,CAAP;AAoBD,GAnCD;AAoCD,C","file":"PgOrderByPrimaryKeyPlugin.js","sourcesContent":["// @flow\nimport type { Plugin } from \"graphile-build\";\n\nexport default (function PgOrderByPrimaryKeyPlugin(builder) {\n  builder.hook(\"GraphQLEnumType:values\", (values, build, context) => {\n    const { extend } = build;\n    const {\n      scope: { isPgRowSortEnum, pgIntrospection: table },\n    } = context;\n\n    if (!isPgRowSortEnum || !table || table.kind !== \"class\") {\n      return values;\n    }\n    const primaryKeyConstraint = table.primaryKeyConstraint;\n    if (!primaryKeyConstraint) {\n      return values;\n    }\n    const primaryKeys = primaryKeyConstraint.keyAttributes;\n\n    return extend(\n      values,\n      {\n        PRIMARY_KEY_ASC: {\n          value: {\n            alias: \"primary_key_asc\",\n            specs: primaryKeys.map(key => [key.name, true]),\n            unique: true,\n          },\n        },\n        PRIMARY_KEY_DESC: {\n          value: {\n            alias: \"primary_key_desc\",\n            specs: primaryKeys.map(key => [key.name, false]),\n            unique: true,\n          },\n        },\n      },\n      `Adding primary key asc/desc sort to table '${table.name}'`\n    );\n  });\n}: Plugin);\n"]}